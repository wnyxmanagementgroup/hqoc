<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .glass {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }
        .glass-dark {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .btn-primary {
            background: linear-gradient(135deg, #3D449A 0%, #5B63D1 100%);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(61, 68, 154, 0.3);
        }
        .file-drop-area.active {
            border-color: #3D449A;
            background-color: rgba(61, 68, 154, 0.05);
        }
    </style>
</head>
<body class="p-4 sm:p-8 min-h-screen bg-gradient-to-br from-pink-100 to-blue-200 antialiased">
    
    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏´‡∏•‡∏±‡∏Å -->
    <div id="dashboardPage">
        <header class="glass mb-8 p-6">
            <div class="flex flex-col md:flex-row md:items-center justify-between">
                <div class="flex items-center justify-center mb-4 md:mb-0 md:justify-start">
                    <img src="https://img5.pic.in.th/file/secure-sv1/WNY-App-.png" alt="Logo" class="h-20 w-auto">
                </div>
                <div class="flex items-center justify-center md:justify-end">
                    <button id="adminLoginBtn" class="px-4 py-2 btn-primary text-white rounded-lg font-semibold">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•)</button>
                </div>
            </div>
        </header>

        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
        <div class="glass p-6 mb-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</h2>
            <div class="mb-4">
                <div class="flex flex-wrap gap-4">
                    <div class="flex items-center">
                        <input type="radio" id="searchByDocNo" name="searchType" value="docNo" class="mr-2" checked>
                        <label for="searchByDocNo" class="text-gray-700">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≤‡∏°‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</label>
                    </div>
                    <div class="flex items-center">
                        <input type="radio" id="searchByTitle" name="searchType" value="title" class="mr-2">
                        <label for="searchByTitle" class="text-gray-700">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
                    </div>
                </div>
            </div>
            <div class="flex flex-col sm:flex-row gap-4">
                <input type="text" id="searchInput" class="flex-grow px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">
                <button id="searchBtn" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold whitespace-nowrap">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
            </div>
            
            <!-- ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
            <div id="searchResults" class="mt-6 hidden">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
                <div class="bg-white bg-opacity-70 rounded-lg p-4">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b">
                                <th class="text-left py-2">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</th>
                                <th class="text-left py-2">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
                                <th class="text-left py-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                <th class="text-left py-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            </tr>
                        </thead>
                        <tbody id="searchResultsBody">
                            <!-- ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ -->
        <div class="glass p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h2>
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4">
                <div class="flex flex-col sm:flex-row sm:items-center gap-4">
                    <div class="flex items-center gap-2">
                        <label for="publicYear1Select" class="text-gray-700 whitespace-nowrap">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö:</label>
                        <select id="publicYear1Select" class="px-3 py-2 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="2566">‡∏û.‡∏®. 2566</option>
                            <option value="2567">‡∏û.‡∏®. 2567</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <label for="publicYear2Select" class="text-gray-700">‡∏Å‡∏±‡∏ö:</label>
                        <select id="publicYear2Select" class="px-3 py-2 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="2566">‡∏û.‡∏®. 2566</option>
                            <option value="2567" selected>‡∏û.‡∏®. 2567</option>
                        </select>
                    </div>
                </div>
                <button id="publicUpdateStatsBtn" class="btn-primary text-white px-5 py-2 rounded-lg font-semibold w-full sm:w-auto">‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</button>
            </div>
            <div>
                <canvas id="publicMonthlyStatsChart" class="w-full"></canvas>
            </div>
        </div>
    </div>

    <!-- Modal ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="w-full max-w-md mx-4">
            <div class="glass p-8 rounded-2xl">
                <div class="text-center mb-8">
                    <div class="flex justify-center mb-4">
                        <img src="https://img5.pic.in.th/file/secure-sv1/WNY-App-.png" alt="Logo" class="h-24 w-auto">
                    </div>
                    <p class="text-gray-600 mt-2">‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</p>
                </div>
                <form id="loginForm">
                    <div class="mb-6">
                        <label for="username" class="block text-gray-700 mb-2 font-medium">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
                        <input type="text" id="username" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" required>
                    </div>
                    <div class="mb-6">
                        <label for="password" class="block text-gray-700 mb-2 font-medium">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                        <input type="password" id="password" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
                    </div>
                    <div class="flex space-x-4">
                        <button type="button" id="cancelLogin" class="flex-1 px-4 py-3 bg-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-400 transition">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button type="submit" class="flex-1 btn-primary text-white py-3 rounded-lg font-semibold shadow-lg">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏• -->
    <div id="adminDashboard" class="hidden">
        <header class="glass mb-8 p-6">
            <div class="flex flex-col md:flex-row md:items-center justify-between">
                <div class="flex items-center justify-center mb-4 md:mb-0 md:justify-start">
                    <img src="https://img5.pic.in.th/file/secure-sv1/WNY-App-.png" alt="Logo" class="h-20 w-auto">
                </div>
                <div class="flex items-center justify-center md:justify-end">
                    <span class="text-gray-700 mr-4 hidden sm:inline">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</span>
                    <button id="logoutBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ -->
            <div class="lg:col-span-1">
                <div class="glass p-6 mb-8">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">‡πÄ‡∏°‡∏ô‡∏π‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h2>
                    <ul class="space-y-2">
                        <li><button id="adminSearchTab" class="w-full text-left px-4 py-3 rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50 text-indigo-600 font-medium flex items-center">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</button></li>
                        <li><button id="adminUploadTab" class="w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 transition text-gray-700 flex items-center">üì§ ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</button></li>
                        <li><button id="adminChangePasswordTab" class="w-full text-left px-4 py-3 rounded-lg hover:bg-gray-100 transition text-gray-700 flex items-center">üîí ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button></li>
                    </ul>
                </div>
            </div>

            <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
            <div class="lg:col-span-2">
                <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
                <div id="adminSearchSection">
                    <div class="glass p-6">
                        <h2 class="text-xl font-semibold text-gray-800 mb-4">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</h2>
                        <div class="mb-4">
                            <div class="flex flex-wrap gap-4">
                                <div class="flex items-center">
                                    <input type="radio" id="adminSearchByDocNo" name="adminSearchType" value="docNo" class="mr-2" checked>
                                    <label for="adminSearchByDocNo" class="text-gray-700">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≤‡∏°‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="radio" id="adminSearchByTitle" name="adminSearchType" value="title" class="mr-2">
                                    <label for="adminSearchByTitle" class="text-gray-700">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="text" id="adminSearchInput" class="flex-grow px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...">
                            <button id="adminSearchBtn" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold whitespace-nowrap">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        </div>
                        
                        <!-- ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏• -->
                        <div id="adminSearchResults" class="mt-6 hidden">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
                            <div class="bg-white bg-opacity-70 rounded-lg p-4">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b">
                                            <th class="text-left py-2">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</th>
                                            <th class="text-left py-2">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</th>
                                            <th class="text-left py-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                            <th class="text-left py-2">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                        </tr>
                                    </thead>
                                    <tbody id="adminSearchResultsBody">
                                        <!-- ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î -->
                <div id="adminUploadSection" class="hidden">
                    <div class="glass p-6">
                        <h2 class="text-xl font-semibold text-gray-800 mb-6">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà</h2>
                        <form id="adminUploadForm">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="adminDocumentNumber" class="block text-gray-700 mb-2 font-medium">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ *</label>
                                    <input type="text" id="adminDocumentNumber" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠" required>
                                </div>
                                <div>
                                    <label for="adminTitle" class="block text-gray-700 mb-2 font-medium">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á *</label>
                                    <input type="text" id="adminTitle" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á" required>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="adminDate" class="block text-gray-700 mb-2 font-medium">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà *</label>
                                    <input type="date" id="adminDate" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" required>
                                </div>
                                <div>
                                    <label for="adminDepartment" class="block text-gray-700 mb-2 font-medium">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô *</label>
                                    <select id="adminDepartment" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" required>
                                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</option>
                                        <option value="‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</option>
                                        <option value="‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£">‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£</option>
                                        <option value="‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
                                        <option value="‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì">‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mb-6">
                                <label for="adminDetails" class="block text-gray-700 mb-2 font-medium">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
                                <textarea id="adminDetails" rows="3" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"></textarea>
                            </div>
                            <div class="mb-6">
                                <label for="adminFile" class="block text-gray-700 mb-2 font-medium">‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (PDF)</label>
                                <input type="file" id="adminFile" accept=".pdf" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                            </div>
                            <button type="submit" class="w-full btn-primary text-white py-3 rounded-lg font-semibold shadow-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                        </form>
                    </div>
                </div>

                <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô -->
                <div id="adminChangePasswordSection" class="hidden">
                    <div class="glass p-6">
                        <h2 class="text-xl font-semibold text-gray-800 mb-6">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h2>
                        <form id="changePasswordForm">
                            <div class="mb-6">
                                <label for="adminOldPassword" class="block text-gray-700 mb-2 font-medium">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡πà‡∏≤ *</label>
                                <input type="password" id="adminOldPassword" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" required>
                            </div>
                            <div class="mb-6">
                                <label for="adminNewPassword" class="block text-gray-700 mb-2 font-medium">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà *</label>
                                <input type="password" id="adminNewPassword" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" required>
                            </div>
                            <div class="mb-6">
                                <label for="adminConfirmPassword" class="block text-gray-700 mb-2 font-medium">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà *</label>
                                <input type="password" id="adminConfirmPassword" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-70 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition" required>
                            </div>
                            <button type="submit" class="w-full btn-primary text-white py-3 rounded-lg font-semibold shadow-lg">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
    <div id="customAlertModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] hidden">
        <div class="w-full max-w-md mx-4">
            <div class="glass p-6 rounded-2xl shadow-lg">
                <h3 id="customAlertTitle" class="text-xl font-semibold text-gray-800 mb-4">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h3>
                <p id="customAlertMessage" class="text-gray-700 mb-6">‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>
                <button id="customAlertCloseBtn" class="w-full btn-primary text-white py-2 rounded-lg font-semibold">‡∏ï‡∏Å‡∏•‡∏á</button>
            </div>
        </div>
    </div>

    <!-- Modal ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
    <div id="loadingModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-[200] hidden">
        <div class="glass-dark p-8 rounded-2xl flex flex-col items-center">
            <svg class="animate-spin h-10 w-10 text-white mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="text-white text-lg font-semibold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</p>
        </div>
    </div>

    <footer class="text-center text-sm text-gray-600 p-4 mt-8">
        <p>‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏á‡∏ô‡πâ‡∏≥‡πÄ‡∏¢‡πá‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</p>
        <p>‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡∏Å‡∏µ‡∏£‡∏ï‡∏¥ ‡∏õ‡∏£‡∏∞‡∏™‡∏û‡∏û‡∏£‡∏£‡∏±‡∏á‡∏™‡∏µ</p>
    </footer>

    <script>
        // ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ
        // ‚òÖ‚òÖ‚òÖ URL ‡∏Ç‡∏≠‡∏á GOOGLE APPS SCRIPT WEB APP ‚òÖ‚òÖ‚òÖ
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyMjOGrKm39x6fOH8ciiB-9ikBQlElOyUEUCx_fxbxHSO5aW9meiE7ZZBz_i9wvhdWb/exec';
        // ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ Google Apps Script
        async function callGAS(action, method = 'GET', payload = {}) {
            showLoading();
            
            try {
                let url = GOOGLE_SCRIPT_URL;
                const options = {
                    method: method,
                    redirect: 'follow'
                };

                if (method === 'GET') {
                    const params = new URLSearchParams({ action, ...payload });
                    url += `?${params}`;
                } else {
                    options.headers = {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    };
                    // ‡πÅ‡∏õ‡∏•‡∏á payload ‡πÄ‡∏õ‡πá‡∏ô form data format
                    const formData = new URLSearchParams();
                    formData.append('action', action);
                    Object.keys(payload).forEach(key => {
                        formData.append(key, payload[key]);
                    });
                    options.body = formData;
                }

                console.log('Calling GAS:', url, options);
                const response = await fetch(url, options);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                // ‡∏≠‡πà‡∏≤‡∏ô response ‡πÄ‡∏õ‡πá‡∏ô text ‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢ parse ‡πÄ‡∏õ‡πá‡∏ô JSON
                const text = await response.text();
                let result;
                try {
                    result = JSON.parse(text);
                } catch (e) {
                    console.warn('Response is not JSON:', text);
                    result = { success: false, error: '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á' };
                }
                
                hideLoading();
                return result;
                
            } catch (error) {
                hideLoading();
                console.error('GAS API Error:', error);
                return {
                    success: false,
                    error: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ: ' + error.message
                };
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
        function showLoading() {
            const loadingModal = document.getElementById('loadingModal');
            if (loadingModal) loadingModal.classList.remove('hidden');
        }

        function hideLoading() {
            const loadingModal = document.getElementById('loadingModal');
            if (loadingModal) loadingModal.classList.add('hidden');
        }

        function showAlert(message, title = '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°') {
            const customAlertModal = document.getElementById('customAlertModal');
            const customAlertTitle = document.getElementById('customAlertTitle');
            const customAlertMessage = document.getElementById('customAlertMessage');
            
            if (customAlertTitle && customAlertMessage && customAlertModal) {
                customAlertTitle.textContent = title;
                customAlertMessage.textContent = message;
                customAlertModal.classList.remove('hidden');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
        function displaySearchResults(results, isAdmin = false) {
            const resultsContainer = isAdmin ? 
                document.getElementById('adminSearchResults') : 
                document.getElementById('searchResults');
            const resultsBody = isAdmin ? 
                document.getElementById('adminSearchResultsBody') : 
                document.getElementById('searchResultsBody');
                
            if (!resultsContainer || !resultsBody) return;
            
            if (!results || results.length === 0) {
                resultsBody.innerHTML = '<tr><td colspan="4" class="py-4 text-center text-gray-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
                resultsContainer.classList.remove('hidden');
                return;
            }
            
            let html = '';
            results.forEach(doc => {
                html += `
                    <tr class="border-b">
                        <td class="py-3">${doc.documentNumber || '-'}</td>
                        <td class="py-3">${doc.title || '-'}</td>
                        <td class="py-3">${doc.date || '-'}</td>
                        <td class="py-3">
                            ${isAdmin ? 
                                `<button class="text-blue-600 hover:text-blue-800 mr-2" onclick="viewDocument('${doc.id}')">‡∏î‡∏π</button>
                                 <button class="text-green-600 hover:text-green-800 mr-2" onclick="editDocument('${doc.id}')">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                 <button class="text-red-600 hover:text-red-800" onclick="deleteDocument('${doc.id}')">‡∏•‡∏ö</button>` :
                                `<span class="text-green-600">‚úì ‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</span>`
                            }
                        </td>
                    </tr>
                `;
            });
            
            resultsBody.innerHTML = html;
            resultsContainer.classList.remove('hidden');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•)
        function viewDocument(id) {
            showAlert(`‡∏î‡∏π‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ID: ${id}`, '‡∏î‡∏π‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£');
        }

        function editDocument(id) {
            showAlert(`‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ID: ${id}`, '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£');
        }

        function deleteDocument(id) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ?')) {
                showAlert(`‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ID: ${id}`, '‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
        function createMonthlyStatsChart(year1, year2) {
            const ctx = document.getElementById('publicMonthlyStatsChart');
            if (!ctx) return;
            
            // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á - ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å GAS
            const data1 = [12, 19, 15, 17, 14, 16, 18, 20, 22, 19, 17, 21];
            const data2 = [10, 15, 18, 16, 20, 22, 19, 23, 25, 22, 20, 24];
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.', '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'],
                    datasets: [
                        {
                            label: `‡∏û.‡∏®. ${year1}`,
                            data: data1,
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: `‡∏û.‡∏®. ${year2}`,
                            data: data2,
                            borderColor: 'rgb(139, 92, 246)',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: '‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠'
                            }
                        }
                    }
                }
            });
        }

        // ‡πÄ‡∏°‡∏∑‡πà‡∏≠ DOM ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô...');
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            const today = new Date().toISOString().split('T')[0];
            const adminDateInput = document.getElementById('adminDate');
            if (adminDateInput) {
                adminDateInput.value = today;
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            createMonthlyStatsChart(2566, 2567);

            // ‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;

                    if (!username || !password) {
                        showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô');
                        return;
                    }

                    const result = await callGAS('login', 'POST', {
                        username: username,
                        password: password
                    });

                    if (result.success) {
                        showAlert('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                        document.getElementById('loginModal').classList.add('hidden');
                        document.getElementById('dashboardPage').classList.add('hidden');
                        document.getElementById('adminDashboard').classList.remove('hidden');
                        loginForm.reset();
                    } else {
                        showAlert(result.error || '‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
                    }
                });
            }

            // ‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
            document.getElementById('searchBtn').addEventListener('click', async function() {
                const searchType = document.querySelector('input[name="searchType"]:checked').value;
                const searchInput = document.getElementById('searchInput').value;
                
                if (!searchInput) {
                    showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
                    return;
                }
                
                const result = await callGAS('search', 'GET', {
                    type: searchType,
                    query: searchInput
                });
                
                if (result.success) {
                    displaySearchResults(result.data);
                } else {
                    showAlert(result.error || '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
                }
            });

            // ‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•
            document.getElementById('adminSearchBtn').addEventListener('click', async function() {
                const searchType = document.querySelector('input[name="adminSearchType"]:checked').value;
                const searchInput = document.getElementById('adminSearchInput').value;
                
                if (!searchInput) {
                    showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
                    return;
                }
                
                const result = await callGAS('search', 'GET', {
                    type: searchType,
                    query: searchInput
                });
                
                if (result.success) {
                    displaySearchResults(result.data, true);
                } else {
                    showAlert(result.error || '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
                }
            });

            // ‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
            const adminUploadForm = document.getElementById('adminUploadForm');
            if (adminUploadForm) {
                adminUploadForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const documentNumber = document.getElementById('adminDocumentNumber').value;
                    const title = document.getElementById('adminTitle').value;
                    const date = document.getElementById('adminDate').value;
                    const department = document.getElementById('adminDepartment').value;
                    const details = document.getElementById('adminDetails').value;
                    
                    if (!documentNumber || !title || !date || !department) {
                        showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                        return;
                    }
                    
                    const result = await callGAS('upload', 'POST', {
                        documentNumber: documentNumber,
                        title: title,
                        date: date,
                        department: department,
                        details: details
                    });
                    
                    if (result.success) {
                        showAlert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                        adminUploadForm.reset();
                        document.getElementById('adminDate').value = today;
                    } else {
                        showAlert(result.error || '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
                    }
                });
            }

            // ‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
            const changePasswordForm = document.getElementById('changePasswordForm');
            if (changePasswordForm) {
                changePasswordForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const oldPassword = document.getElementById('adminOldPassword').value;
                    const newPassword = document.getElementById('adminNewPassword').value;
                    const confirmPassword = document.getElementById('adminConfirmPassword').value;
                    
                    if (!oldPassword || !newPassword || !confirmPassword) {
                        showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î');
                        return;
                    }
                    
                    if (newPassword !== confirmPassword) {
                        showAlert('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô');
                        return;
                    }
                    
                    const result = await callGAS('changePassword', 'POST', {
                        oldPassword: oldPassword,
                        newPassword: newPassword
                    });
                    
                    if (result.success) {
                        showAlert('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                        changePasswordForm.reset();
                    } else {
                        showAlert(result.error || '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');
                    }
                });
            }

            // ‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•
            document.getElementById('adminSearchTab').addEventListener('click', function() {
                document.getElementById('adminSearchSection').classList.remove('hidden');
                document.getElementById('adminUploadSection').classList.add('hidden');
                document.getElementById('adminChangePasswordSection').classList.add('hidden');
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ó‡πá‡∏ö
                document.querySelectorAll('#adminDashboard [id$="Tab"]').forEach(tab => {
                    tab.classList.remove('bg-gradient-to-r', 'from-blue-50', 'to-indigo-50', 'text-indigo-600');
                    tab.classList.add('hover:bg-gray-100', 'text-gray-700');
                });
                this.classList.add('bg-gradient-to-r', 'from-blue-50', 'to-indigo-50', 'text-indigo-600');
                this.classList.remove('hover:bg-gray-100', 'text-gray-700');
            });

            document.getElementById('adminUploadTab').addEventListener('click', function() {
                document.getElementById('adminSearchSection').classList.add('hidden');
                document.getElementById('adminUploadSection').classList.remove('hidden');
                document.getElementById('adminChangePasswordSection').classList.add('hidden');
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ó‡πá‡∏ö
                document.querySelectorAll('#adminDashboard [id$="Tab"]').forEach(tab => {
                    tab.classList.remove('bg-gradient-to-r', 'from-blue-50', 'to-indigo-50', 'text-indigo-600');
                    tab.classList.add('hover:bg-gray-100', 'text-gray-700');
                });
                this.classList.add('bg-gradient-to-r', 'from-blue-50', 'to-indigo-50', 'text-indigo-600');
                this.classList.remove('hover:bg-gray-100', 'text-gray-700');
            });

            document.getElementById('adminChangePasswordTab').addEventListener('click', function() {
                document.getElementById('adminSearchSection').classList.add('hidden');
                document.getElementById('adminUploadSection').classList.add('hidden');
                document.getElementById('adminChangePasswordSection').classList.remove('hidden');
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ó‡πá‡∏ö
                document.querySelectorAll('#adminDashboard [id$="Tab"]').forEach(tab => {
                    tab.classList.remove('bg-gradient-to-r', 'from-blue-50', 'to-indigo-50', 'text-indigo-600');
                    tab.classList.add('hover:bg-gray-100', 'text-gray-700');
                });
                this.classList.add('bg-gradient-to-r', 'from-blue-50', 'to-indigo-50', 'text-indigo-600');
                this.classList.remove('hover:bg-gray-100', 'text-gray-700');
            });

            // ‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ
            document.getElementById('adminLoginBtn').addEventListener('click', function() {
                document.getElementById('loginModal').classList.remove('hidden');
            });

            document.getElementById('cancelLogin').addEventListener('click', function() {
                document.getElementById('loginModal').classList.add('hidden');
            });

            document.getElementById('logoutBtn').addEventListener('click', function() {
                document.getElementById('adminDashboard').classList.add('hidden');
                document.getElementById('dashboardPage').classList.remove('hidden');
                showAlert('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            });

            document.getElementById('customAlertCloseBtn').addEventListener('click', function() {
                document.getElementById('customAlertModal').classList.add('hidden');
            });

            document.getElementById('publicUpdateStatsBtn').addEventListener('click', function() {
                const year1 = document.getElementById('publicYear1Select').value;
                const year2 = document.getElementById('publicYear2Select').value;
                createMonthlyStatsChart(year1, year2);
            });

            // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
            testConnection();
        });

        // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
        async function testConnection() {
            const result = await callGAS('test', 'GET');
            console.log('Connection test:', result);
        }
    </script>
</body>
</html>
